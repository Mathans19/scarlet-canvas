<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}WANDA Analytics{% endblock %}</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    /* ==================== CSS RESET & VARIABLES ==================== */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --scarlet: 348 83% 47%;
      --scarlet-dark: 348 83% 27%;
      --scarlet-glow: 348 100% 60%;
      --crimson: 0 84% 40%;
      --blood: 0 100% 25%;
      --darkhold: 0 100% 15%;
      --mystic: 280 60% 50%;
      --mystic-dark: 280 60% 20%;
      --chaos: 320 70% 40%;
      --background: 240 10% 4%;
      --foreground: 0 0% 95%;
      --card: 240 10% 8%;
      --muted: 240 10% 12%;
      --muted-foreground: 240 5% 55%;
      --border: 240 10% 18%;
      --radius: 0.75rem;
      --glow-sm: 0 0 10px hsl(var(--scarlet) / 0.5);
      --glow-md: 0 0 20px hsl(var(--scarlet) / 0.4), 0 0 40px hsl(var(--scarlet) / 0.2);
      --glow-lg: 0 0 30px hsl(var(--scarlet) / 0.5), 0 0 60px hsl(var(--scarlet) / 0.3), 0 0 100px hsl(var(--scarlet) / 0.1);
      --glass-bg: hsla(240, 10%, 8%, 0.7);
      --glass-border: hsl(348 83% 47% / 0.3);
    }

    html {
      font-size: 16px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      background: hsl(var(--background));
      color: hsl(var(--foreground));
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Cinzel', serif;
    }

    /* ==================== BACKGROUND EFFECTS ==================== */
    .wanda-bg {
      position: fixed;
      inset: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0.15;
      filter: saturate(1.2);
      pointer-events: none;
      z-index: 0;
    }

    .wanda-bg::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, hsl(var(--background)) 0%, transparent 30%, transparent 70%, hsl(var(--background)) 100%);
    }

    .bg-chaos {
      position: fixed;
      inset: 0;
      background: radial-gradient(ellipse at center, hsl(var(--scarlet-dark) / 0.2), transparent 70%);
      pointer-events: none;
    }

    .vignette {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 2;
      background: radial-gradient(ellipse at center, transparent 40%, hsl(var(--background) / 0.8) 100%);
    }

    .hex-pattern {
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 0L60 15V45L30 60L0 45V15L30 0z' fill='none' stroke='%23DC143C' stroke-opacity='0.05'/%3E%3C/svg%3E");
      background-size: 60px 60px;
    }

    .comic-dots {
      background-image: radial-gradient(hsl(var(--scarlet) / 0.1) 1px, transparent 1px);
      background-size: 20px 20px;
    }

    /* ==================== TV STATIC OVERLAY ==================== */
    .tv-static::before {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, hsl(var(--scarlet) / 0.03) 2px, hsl(var(--scarlet) / 0.03) 4px);
      pointer-events: none;
      animation: scanlines 0.1s linear infinite;
    }

    @keyframes scanlines {
      0% { transform: translateY(0); }
      100% { transform: translateY(4px); }
    }

    /* ==================== ENERGY ORBS ==================== */
    .energy-orb {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
      background: radial-gradient(circle, hsl(var(--scarlet-glow)), transparent 70%);
      filter: blur(1px);
      animation: orbFloat 10s ease-in-out infinite;
    }

    @keyframes orbFloat {
      0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.6; }
      33% { transform: translate(30px, -20px) scale(1.1); opacity: 0.8; }
      66% { transform: translate(-20px, 10px) scale(0.9); opacity: 0.5; }
    }

    /* ==================== DARKHOLD RUNES ==================== */
    .darkhold-runes {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 1;
    }

    .rune {
      position: absolute;
      font-family: 'Cinzel', serif;
      color: hsl(var(--scarlet) / 0.15);
      text-shadow: 0 0 20px hsl(var(--scarlet) / 0.5);
      animation: rune-float 15s ease-in-out infinite;
    }

    @keyframes rune-float {
      0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.1; }
      50% { transform: translateY(-30px) rotate(10deg); opacity: 0.3; }
    }

    /* ==================== HEX OVERLAY ==================== */
    .hex-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 3;
    }

    .hex-corner {
      position: absolute;
      animation: hex-pulse 4s ease-in-out infinite;
    }

    @keyframes hex-pulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.6; }
    }

    .hex-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: hex-spin 60s linear infinite;
    }

    @keyframes hex-spin {
      from { transform: translate(-50%, -50%) rotate(0deg); }
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }

    /* ==================== NAVBAR ==================== */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 50;
    }

    .navbar-backdrop {
      position: absolute;
      inset: 0;
      background: hsl(var(--background) / 0.6);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid hsl(var(--border));
    }

    .navbar-energy-line {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, hsl(var(--scarlet) / 0.5), transparent);
    }

    .navbar-content {
      position: relative;
      max-width: 1280px;
      margin: 0 auto;
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .navbar-logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background: linear-gradient(135deg, hsl(var(--scarlet)), hsl(var(--mystic)));
      display: flex;
      align-items: center;
      justify-content: center;
      animation: pulse-glow 2s ease-in-out infinite;
    }

    @keyframes pulse-glow {
      0%, 100% { box-shadow: var(--glow-sm); }
      50% { box-shadow: var(--glow-lg); }
    }

    .logo-text {
      font-family: 'Cinzel', serif;
      font-size: 1.25rem;
      letter-spacing: 0.05em;
    }

    .gradient-text {
      background: linear-gradient(135deg, hsl(var(--scarlet-glow)), hsl(var(--scarlet)), hsl(var(--mystic)));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 600;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .nav-link {
      position: relative;
      padding: 0.5rem 1rem;
      color: hsl(var(--muted-foreground));
      text-decoration: none;
      font-family: 'Inter', sans-serif;
      font-size: 0.875rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
    }

    .nav-link::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 2px;
      transform: translateX(-50%);
      background: linear-gradient(90deg, transparent, hsl(var(--scarlet)), transparent);
      box-shadow: var(--glow-sm);
      transition: all 0.3s ease;
    }

    .nav-link:hover, .nav-link.active {
      color: hsl(var(--foreground));
    }

    .nav-link:hover::after, .nav-link.active::after {
      width: 100%;
    }

    .nav-link.active {
      text-shadow: 0 0 10px hsl(var(--scarlet) / 0.5);
    }

    .nav-link.active svg {
      color: hsl(var(--scarlet));
      filter: drop-shadow(0 0 8px hsl(348 83% 50%));
    }

    .nav-icon {
      width: 16px;
      height: 16px;
    }

    .status-indicator {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.75rem;
      color: hsl(var(--muted-foreground));
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: hsl(var(--scarlet));
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* ==================== MAIN CONTENT ==================== */
    .main-content {
      position: relative;
      z-index: 10;
      padding-top: 6rem;
      padding-bottom: 3rem;
    }

    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }

    /* ==================== GLASS CARD ==================== */
    .glass-card {
      position: relative;
      overflow: hidden;
      border-radius: var(--radius);
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      box-shadow: var(--glow-sm);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .glass-card:hover {
      border-color: hsl(var(--scarlet) / 0.5);
      box-shadow: var(--glow-md);
      transform: translateY(-2px);
    }

    .tilt-card {
      transform-style: preserve-3d;
      transition: transform 0.2s ease-out;
    }

    .tilt-card .glow-overlay {
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
    }

    .tilt-card:hover .glow-overlay {
      opacity: 1;
    }

    /* ==================== MAGIC BUTTON ==================== */
    .magic-btn {
      position: relative;
      overflow: hidden;
      border-radius: 8px;
      font-weight: 500;
      border: 1px solid;
      transition: all 0.3s ease;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .magic-btn.primary {
      background: linear-gradient(135deg, hsl(var(--scarlet-dark)), hsl(var(--blood)));
      border-color: hsl(var(--scarlet) / 0.5);
      color: white;
      box-shadow: 0 0 15px hsl(348 83% 50% / 0.3);
    }

    .magic-btn.primary:hover {
      transform: scale(1.05);
      box-shadow: 0 0 30px hsl(348 83% 50% / 0.5);
    }

    .magic-btn.secondary {
      background: hsl(var(--muted) / 0.5);
      border-color: hsl(var(--border));
      color: hsl(var(--foreground));
    }

    .magic-btn.secondary:hover {
      background: hsl(var(--muted));
      transform: scale(1.05);
    }

    .magic-btn.ghost {
      background: transparent;
      border-color: transparent;
      color: hsl(var(--muted-foreground));
    }

    .magic-btn.ghost:hover {
      color: hsl(var(--foreground));
      background: hsl(var(--muted) / 0.3);
    }

    .magic-btn.sm { padding: 0.5rem 1rem; font-size: 0.875rem; }
    .magic-btn.md { padding: 0.75rem 1.5rem; font-size: 1rem; }
    .magic-btn.lg { padding: 1rem 2rem; font-size: 1.125rem; }

    .magic-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    .magic-btn .shimmer {
      position: absolute;
      inset: 0;
      opacity: 0;
      background: linear-gradient(90deg, transparent, hsl(0 0% 100% / 0.1), transparent);
      animation: shimmer 2s infinite;
    }

    .magic-btn:hover .shimmer { opacity: 1; }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* Energy burst effect */
    .energy-burst {
      position: absolute;
      pointer-events: none;
    }

    .burst-core {
      position: absolute;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: radial-gradient(circle, hsl(348 100% 70%), hsl(348 83% 50%), transparent);
      animation: energyCore 0.6s ease-out forwards;
    }

    .burst-ring {
      position: absolute;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 2px solid hsl(var(--scarlet));
      box-shadow: 0 0 20px hsl(348 83% 50% / 0.5);
      animation: chaosRing 0.6s ease-out forwards;
      margin-left: -12px;
      margin-top: -12px;
    }

    .burst-hex {
      position: absolute;
      width: 60px;
      height: 60px;
      margin-left: -30px;
      margin-top: -30px;
      animation: hexBurst 0.8s ease-out forwards;
    }

    .burst-particle {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: hsl(var(--scarlet-glow));
      box-shadow: 0 0 6px hsl(348 100% 60%);
      animation: energyParticle 0.8s ease-out forwards;
    }

    @keyframes energyCore {
      0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
      50% { transform: translate(-50%, -50%) scale(3); opacity: 0.8; }
      100% { transform: translate(-50%, -50%) scale(5); opacity: 0; }
    }

    @keyframes chaosRing {
      0% { transform: scale(0); opacity: 1; }
      100% { transform: scale(4); opacity: 0; }
    }

    @keyframes hexBurst {
      0% { transform: scale(0) rotate(0deg); opacity: 1; }
      100% { transform: scale(2) rotate(30deg); opacity: 0; }
    }

    @keyframes energyParticle {
      0% { transform: translateX(0); opacity: 1; }
      100% { transform: translateX(40px); opacity: 0; }
    }

    /* ==================== CHAOS SPINNER ==================== */
    .chaos-spinner {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .spinner-container {
      position: relative;
    }

    .spinner-ring {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      border: 2px solid transparent;
    }

    .spinner-hex {
      position: absolute;
      inset: 0;
      opacity: 0.3;
    }

    .spinner-wisp {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: hsl(var(--scarlet-glow));
      box-shadow: 0 0 10px hsl(348 100% 60%), 0 0 20px hsl(348 83% 50% / 0.5);
    }

    .spinner-core {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 50%;
      background: radial-gradient(circle, hsl(348 100% 70%), hsl(348 83% 40%), hsl(280 60% 30%));
      box-shadow: 0 0 20px hsl(348 100% 60%), 0 0 40px hsl(348 83% 50% / 0.5), inset 0 0 10px hsl(0 0% 100% / 0.3);
      animation: pulse-glow 1.5s ease-in-out infinite;
    }

    .spinner-rune {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: hsl(var(--scarlet-glow));
      opacity: 0.6;
      font-family: 'Cinzel', serif;
      text-shadow: 0 0 10px hsl(348 100% 60%);
    }

    .spinner-text {
      font-size: 0.875rem;
      color: hsl(var(--muted-foreground));
      font-family: 'Cinzel', serif;
      letter-spacing: 0.1em;
      animation: pulse 2s ease-in-out infinite;
    }

    /* ==================== PAGE TRANSITION ==================== */
    .page-transition-overlay {
      position: fixed;
      inset: 0;
      z-index: 200;
      pointer-events: none;
      overflow: hidden;
    }

    .page-left, .page-right {
      position: absolute;
      top: 0;
      width: 50%;
      height: 100%;
    }

    .page-left {
      left: 0;
      background: linear-gradient(90deg, hsl(240 10% 6%), hsl(240 10% 8%));
      box-shadow: inset -20px 0 60px hsl(348 83% 30% / 0.3);
      transform-origin: right;
      animation: pageFlipLeft 0.8s ease-in-out forwards;
    }

    .page-right {
      right: 0;
      background: linear-gradient(-90deg, hsl(240 10% 6%), hsl(240 10% 8%));
      box-shadow: inset 20px 0 60px hsl(348 83% 30% / 0.3);
      transform-origin: left;
      animation: pageFlipRight 0.8s ease-in-out forwards;
    }

    .page-runes {
      position: absolute;
      inset: 0;
      padding: 2rem;
      opacity: 0.3;
      overflow: hidden;
    }

    .page-rune {
      display: inline-block;
      color: hsl(var(--scarlet));
      margin: 0.25rem 0.5rem;
      text-shadow: 0 0 10px hsl(348 83% 50%);
    }

    .page-glow-edge {
      position: absolute;
      top: 0;
      width: 8px;
      height: 100%;
      background: linear-gradient(90deg, transparent, hsl(348 100% 60%));
      box-shadow: 0 0 30px hsl(348 100% 60%), 0 0 60px hsl(348 83% 50%);
    }

    .page-left .page-glow-edge { right: 0; }
    .page-right .page-glow-edge { left: 0; background: linear-gradient(-90deg, transparent, hsl(348 100% 60%)); }

    .page-center-glow {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 100%;
      background: hsl(348 100% 60%);
      box-shadow: 0 0 40px 10px hsl(348 100% 60%), 0 0 80px 20px hsl(348 83% 50%);
      animation: centerGlow 0.8s ease-in-out;
    }

    @keyframes pageFlipLeft {
      0% { transform: rotateY(0deg); }
      50% { transform: rotateY(-90deg); }
      100% { transform: rotateY(-180deg); opacity: 0; }
    }

    @keyframes pageFlipRight {
      0% { transform: rotateY(0deg); }
      50% { transform: rotateY(90deg); }
      100% { transform: rotateY(180deg); opacity: 0; }
    }

    @keyframes centerGlow {
      0% { opacity: 0; transform: translateX(-50%) scaleY(0); }
      30% { opacity: 1; transform: translateX(-50%) scaleY(1); }
      70% { opacity: 1; transform: translateX(-50%) scaleY(1); }
      100% { opacity: 0; transform: translateX(-50%) scaleY(0); }
    }

    /* ==================== AUDIO TOGGLE ==================== */
    .audio-toggle {
      position: fixed;
      bottom: 1.5rem;
      left: 1.5rem;
      z-index: 50;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
    }

    .audio-toggle:hover { transform: scale(1.1); }

    .audio-toggle.playing {
      box-shadow: 0 0 20px hsl(348 83% 50% / 0.5), 0 0 40px hsl(348 83% 50% / 0.3);
    }

    .sound-wave {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      border: 1px solid hsl(var(--scarlet) / 0.3);
      animation: soundWave 2s ease-out infinite;
    }

    @keyframes soundWave {
      0% { transform: scale(1); opacity: 0.5; }
      100% { transform: scale(2); opacity: 0; }
    }

    /* ==================== CROWN WATERMARK ==================== */
    .crown-watermark {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      opacity: 0.1;
      pointer-events: none;
      z-index: 20;
    }

    /* ==================== GLITCH EFFECT ==================== */
    .glitch-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 100;
    }

    .chromatic-layer {
      position: absolute;
      inset: 0;
      mix-blend-mode: screen;
    }

    .scan-lines {
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, hsl(var(--scarlet) / 0.1) 2px, hsl(var(--scarlet) / 0.1) 4px);
      animation: scanlines 0.05s linear infinite;
    }

    .reality-tear {
      position: absolute;
      inset: 0;
    }

    /* ==================== CHAOS ENERGY ==================== */
    .chaos-energy {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 2;
    }

    .energy-wisp {
      position: absolute;
      border-radius: 50%;
      filter: blur(1px);
    }

    .mouse-follower {
      position: fixed;
      pointer-events: none;
      z-index: 100;
    }

    .follower-ring {
      position: absolute;
      border-radius: 50%;
      border: 1px solid hsl(var(--scarlet) / 0.3);
    }

    .energy-tendril {
      position: absolute;
    }

    /* ==================== REALITY GLITCH ==================== */
    .reality-glitch {
      animation: reality-glitch 8s ease-in-out infinite;
    }

    @keyframes reality-glitch {
      0%, 95%, 100% { filter: none; transform: none; }
      96% { filter: hue-rotate(90deg) saturate(2); transform: skewX(-2deg) translateX(3px); }
      97% { filter: invert(0.1) hue-rotate(-30deg); transform: skewX(1deg) translateX(-2px); }
      98% { filter: saturate(3) contrast(1.2); transform: translateY(-2px); }
    }

    /* ==================== PARTICLE FIELD ==================== */
    .particle-canvas {
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: 0.6;
      z-index: 1;
    }

    /* ==================== TEXT EFFECTS ==================== */
    .text-glow {
      text-shadow: 0 0 10px hsl(var(--scarlet) / 0.5), 0 0 20px hsl(var(--scarlet) / 0.3);
    }

    .text-glow-strong {
      text-shadow: 0 0 20px hsl(var(--scarlet) / 0.8), 0 0 40px hsl(var(--scarlet) / 0.5), 0 0 60px hsl(var(--scarlet) / 0.3);
    }

    /* ==================== FORM ELEMENTS ==================== */
    .mystic-input {
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      background: hsl(var(--muted) / 0.5);
      border: 1px solid hsl(var(--border));
      color: hsl(var(--foreground));
      font-family: 'Inter', sans-serif;
      transition: all 0.3s ease;
    }

    .mystic-input::placeholder { color: hsl(var(--muted-foreground)); }

    .mystic-input:focus {
      outline: none;
      border-color: hsl(var(--scarlet) / 0.5);
      box-shadow: var(--glow-sm);
    }

    /* ==================== SCROLLBAR ==================== */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: hsl(var(--background)); }
    ::-webkit-scrollbar-thumb { background: hsl(var(--scarlet-dark)); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: hsl(var(--scarlet)); box-shadow: var(--glow-sm); }

    /* ==================== UTILITY CLASSES ==================== */
    .float { animation: float 6s ease-in-out infinite; }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .chaos-tendrils { position: relative; overflow: visible; }
    .chaos-tendrils::before, .chaos-tendrils::after {
      content: '';
      position: absolute;
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: radial-gradient(circle, hsl(var(--scarlet) / 0.4), transparent 70%);
      filter: blur(20px);
      animation: tendril-float 8s ease-in-out infinite;
    }
    .chaos-tendrils::before { top: -50px; left: -30px; }
    .chaos-tendrils::after { bottom: -50px; right: -30px; animation-delay: -4s; }

    @keyframes tendril-float {
      0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.5; }
      25% { transform: translate(20px, -20px) scale(1.2); opacity: 0.8; }
      50% { transform: translate(-10px, 10px) scale(0.8); opacity: 0.4; }
      75% { transform: translate(15px, 15px) scale(1.1); opacity: 0.7; }
    }

    .animate-scale-in { animation: scale-in 0.3s ease-out; }
    @keyframes scale-in {
      0% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    .spin-slow { animation: spin 20s linear infinite; }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .hidden { display: none; }
    @media (min-width: 640px) { .sm\:inline { display: inline; } }
    @media (min-width: 768px) { .md\:inline { display: inline; } }
  </style>
</head>

<body class="hex-pattern comic-dots">
  <!-- Wanda Background -->
  <div class="wanda-bg" id="wandaBg"></div>
  
  <!-- Deep background gradient -->
  <div class="bg-chaos"></div>
  
  <!-- Vignette effect -->
  <div class="vignette"></div>
  
  <!-- Darkhold floating runes -->
  <div class="darkhold-runes" id="darkholdRunes"></div>
  
  <!-- Hex overlay -->
  <div class="hex-overlay" id="hexOverlay"></div>
  
  <!-- Chaos energy -->
  <div class="chaos-energy" id="chaosEnergy"></div>
  
  <!-- Glitch effect container -->
  <div class="glitch-overlay" id="glitchOverlay"></div>
  
  <!-- Energy orbs -->
  <div class="energy-orb" style="width: 384px; height: 384px; top: -192px; left: -192px; opacity: 0.3;"></div>
  <div class="energy-orb" style="width: 256px; height: 256px; top: 33%; right: -128px; opacity: 0.2; animation-delay: -3s;"></div>
  <div class="energy-orb" style="width: 192px; height: 192px; bottom: 25%; left: 25%; opacity: 0.25; animation-delay: -5s;"></div>
  <div class="energy-orb" style="width: 320px; height: 320px; bottom: 0; right: 25%; opacity: 0.15; animation-delay: -7s;"></div>
  
  <!-- Particle canvas -->
  <canvas class="particle-canvas" id="particleCanvas"></canvas>
  
  <!-- TV static overlay -->
  <div style="position: fixed; inset: 0; pointer-events: none; z-index: 4; opacity: 0.02;">
    <div class="tv-static" style="width: 100%; height: 100%;"></div>
  </div>
  
  <!-- Navigation -->
  <nav class="navbar">
    <div class="navbar-backdrop"></div>
    <div class="navbar-energy-line"></div>
    <div class="navbar-content">
      <a href="/" class="navbar-logo">
        <div class="logo-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
            <path d="M12 3l1.5 4.5L18 9l-4.5 1.5L12 15l-1.5-4.5L6 9l4.5-1.5L12 3z"/>
            <path d="M5 19l1 3 3-1-1-3-3 1z"/>
            <path d="M19 19l-1 3-3-1 1-3 3 1z"/>
          </svg>
        </div>
        <span class="logo-text">
          <span class="gradient-text">WANDA</span>
          <span style="color: hsl(var(--muted-foreground)); margin-left: 0.25rem; font-family: Inter, sans-serif; font-size: 0.875rem;">Analytics</span>
        </span>
      </a>
      
      <div class="nav-links">
        <a href="/" class="nav-link {% block nav_upload %}{% endblock %}">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          <span class="hidden md:inline">Upload</span>
        </a>
        <a href="/eda/" class="nav-link {% block nav_eda %}{% endblock %}">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>
          <span class="hidden md:inline">EDA Report</span>
        </a>
        <a href="/clean/" class="nav-link {% block nav_clean %}{% endblock %}">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3l1.5 4.5L18 9l-4.5 1.5L12 15l-1.5-4.5L6 9l4.5-1.5L12 3z"/><path d="M5 19l1 3 3-1-1-3-3 1z"/><path d="M19 19l-1 3-3-1 1-3 3 1z"/></svg>
          <span class="hidden md:inline">Clean Data</span>
        </a>
        <a href="/visualize/" class="nav-link {% block nav_visualize %}{% endblock %}">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>
          <span class="hidden md:inline">Visualize</span>
        </a>
        <a href="/insights/" class="nav-link {% block nav_insights %}{% endblock %}">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/><path d="M17.599 6.5a3 3 0 0 0 .399-1.375"/><path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/><path d="M3.477 10.896a4 4 0 0 1 .585-.396"/><path d="M19.938 10.5a4 4 0 0 1 .585.396"/><path d="M6 18a4 4 0 0 1-1.967-.516"/><path d="M19.967 17.484A4 4 0 0 1 18 18"/></svg>
          <span class="hidden md:inline">AI Insights</span>
        </a>
      </div>
      
      <div class="status-indicator">
        <div class="status-dot"></div>
        <span class="hidden sm:inline" style="font-family: Inter, sans-serif;">Reality Online</span>
      </div>
    </div>
  </nav>
  
  <!-- Audio Toggle -->
  <button class="audio-toggle glass-card" id="audioToggle" title="Toggle ambient sounds">
    <svg id="audioIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: hsl(var(--muted-foreground));">
      <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
      <line x1="23" y1="9" x2="17" y2="15"/>
      <line x1="17" y1="9" x2="23" y2="15"/>
    </svg>
    <div id="soundWaves" style="display: none;">
      <div class="sound-wave"></div>
      <div class="sound-wave" style="animation-delay: 0.5s;"></div>
      <div class="sound-wave" style="animation-delay: 1s;"></div>
    </div>
  </button>
  
  <!-- Main Content -->
  <main class="main-content">
    <div class="reality-glitch">
      {% block content %}{% endblock %}
    </div>
  </main>
  
  <!-- Crown Watermark -->
  <div class="crown-watermark">
    <svg width="60" height="50" viewBox="0 0 60 50">
      <defs>
        <linearGradient id="crownGrad" x1="0%" y1="100%" x2="0%" y2="0%">
          <stop offset="0%" stop-color="hsl(348, 83%, 47%)" />
          <stop offset="100%" stop-color="hsl(348, 100%, 60%)" />
        </linearGradient>
      </defs>
      <path d="M30,5 L20,25 L5,20 L15,45 L30,40 L45,45 L55,20 L40,25 L30,5 Z" fill="url(#crownGrad)" style="animation: pulse 2s ease-in-out infinite;"/>
      <circle cx="30" cy="20" r="4" fill="hsl(348, 100%, 70%)" />
    </svg>
  </div>

  <script>
    // ==================== RUNE SYMBOLS ====================
    const RUNE_SYMBOLS = ["ᛟ", "ᚦ", "ᚨ", "ᚱ", "ᚲ", "ᚷ", "ᚹ", "ᚺ", "ᛁ", "ᛃ", "ᛇ", "ᛈ", "ᛉ", "ᛊ", "ᛏ", "ᛒ", "ᛖ", "ᛗ", "ᛚ", "ᛜ", "ᛞ"];

    // ==================== DARKHOLD RUNES ====================
    function initDarkholdRunes() {
      const container = document.getElementById('darkholdRunes');
      for (let i = 0; i < 15; i++) {
        const rune = document.createElement('span');
        rune.className = 'rune';
        rune.textContent = RUNE_SYMBOLS[Math.floor(Math.random() * RUNE_SYMBOLS.length)];
        rune.style.left = Math.random() * 100 + '%';
        rune.style.top = Math.random() * 100 + '%';
        rune.style.fontSize = (1 + Math.random() * 2) + 'rem';
        rune.style.animationDelay = (Math.random() * 10) + 's';
        rune.style.animationDuration = (10 + Math.random() * 10) + 's';
        container.appendChild(rune);
      }
    }

    // ==================== HEX OVERLAY ====================
    function initHexOverlay() {
      const container = document.getElementById('hexOverlay');
      const corners = [
        { top: '10%', left: '5%' },
        { top: '10%', right: '5%' },
        { bottom: '10%', left: '5%' },
        { bottom: '10%', right: '5%' }
      ];
      
      corners.forEach((pos, i) => {
        const hex = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        hex.setAttribute('width', '80');
        hex.setAttribute('height', '80');
        hex.setAttribute('viewBox', '0 0 100 100');
        hex.className = 'hex-corner';
        Object.assign(hex.style, pos);
        hex.style.animationDelay = (i * 0.5) + 's';
        hex.innerHTML = `
          <defs>
            <linearGradient id="hexGrad${i}" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="hsl(348, 83%, 50%)" stop-opacity="0.5"/>
              <stop offset="100%" stop-color="hsl(280, 60%, 50%)" stop-opacity="0.2"/>
            </linearGradient>
          </defs>
          <polygon points="50,5 93,27.5 93,72.5 50,95 7,72.5 7,27.5" fill="none" stroke="url(#hexGrad${i})" stroke-width="1"/>
        `;
        container.appendChild(hex);
      });
      
      // Center hex
      const centerHex = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      centerHex.setAttribute('width', '400');
      centerHex.setAttribute('height', '400');
      centerHex.setAttribute('viewBox', '0 0 400 400');
      centerHex.className = 'hex-center';
      centerHex.style.opacity = '0.1';
      
      let hexPaths = '';
      for (let i = 0; i < 6; i++) {
        const scale = 0.3 + i * 0.12;
        const offset = 200 - (200 * scale);
        hexPaths += `<polygon points="200,${20*scale + offset} ${200 + 186*scale},${200 - 110*scale} ${200 + 186*scale},${200 + 110*scale} 200,${400 - 20*scale - offset} ${200 - 186*scale},${200 + 110*scale} ${200 - 186*scale},${200 - 110*scale}" fill="none" stroke="hsl(348, 83%, 50%)" stroke-width="0.5" transform="rotate(${i * 10}, 200, 200)"/>`;
      }
      centerHex.innerHTML = `<defs><radialGradient id="centerHexGrad"><stop offset="0%" stop-color="hsl(348,83%,50%)" stop-opacity="0.3"/><stop offset="100%" stop-color="hsl(348,83%,50%)" stop-opacity="0"/></radialGradient></defs>${hexPaths}`;
      container.appendChild(centerHex);
    }

    // ==================== CHAOS ENERGY ====================
    function initChaosEnergy() {
      const container = document.getElementById('chaosEnergy');
      
      // Create wisps
      for (let i = 0; i < 8; i++) {
        const wisp = document.createElement('div');
        wisp.className = 'energy-wisp';
        const size = 20 + Math.random() * 40;
        wisp.style.width = size + 'px';
        wisp.style.height = size + 'px';
        wisp.style.left = Math.random() * 100 + '%';
        wisp.style.top = Math.random() * 100 + '%';
        wisp.style.background = `radial-gradient(circle, hsl(${348 + Math.random() * 40 - 20} 83% ${50 + Math.random() * 20}% / ${0.2 + Math.random() * 0.3}), transparent)`;
        wisp.style.animation = `float ${5 + Math.random() * 5}s ease-in-out infinite`;
        wisp.style.animationDelay = (Math.random() * 5) + 's';
        container.appendChild(wisp);
      }
    }

    // ==================== GLITCH EFFECT ====================
    let glitchActive = false;
    function triggerGlitch() {
      if (Math.random() > 0.7) {
        glitchActive = true;
        const overlay = document.getElementById('glitchOverlay');
        const type = Math.floor(Math.random() * 3);
        
        if (type === 0) {
          overlay.innerHTML = `
            <div class="chromatic-layer" style="background: hsl(348 100% 50% / 0.1); transform: translate(-3px, 0);"></div>
            <div class="chromatic-layer" style="background: hsl(200 100% 50% / 0.1); transform: translate(3px, 0);"></div>
          `;
        } else if (type === 1) {
          overlay.innerHTML = '<div class="scan-lines"></div>';
        } else {
          const angle = Math.random() * 360;
          overlay.innerHTML = `<div class="reality-tear" style="background: linear-gradient(${angle}deg, transparent 45%, hsl(348 83% 50% / 0.1) 50%, transparent 55%);"></div>`;
        }
        
        setTimeout(() => {
          overlay.innerHTML = '';
          glitchActive = false;
        }, 100 + Math.random() * 200);
      }
      
      setTimeout(triggerGlitch, 2000 + Math.random() * 5000);
    }

    // ==================== PARTICLE FIELD ====================
    function initParticleField() {
      const canvas = document.getElementById('particleCanvas');
      const ctx = canvas.getContext('2d');
      let particles = [];
      let mouse = { x: null, y: null };
      
      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      
      function createParticles() {
        particles = [];
        const count = Math.floor((canvas.width * canvas.height) / 15000);
        for (let i = 0; i < count; i++) {
          particles.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            size: Math.random() * 2 + 0.5,
            speedX: (Math.random() - 0.5) * 0.5,
            speedY: (Math.random() - 0.5) * 0.5,
            opacity: Math.random() * 0.5 + 0.2,
            hue: 348 + (Math.random() - 0.5) * 40
          });
        }
      }
      
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        particles.forEach((p, i) => {
          // Mouse interaction
          if (mouse.x && mouse.y) {
            const dx = mouse.x - p.x;
            const dy = mouse.y - p.y;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist < 150) {
              const force = (150 - dist) / 150;
              p.x -= (dx / dist) * force * 2;
              p.y -= (dy / dist) * force * 2;
            }
          }
          
          p.x += p.speedX;
          p.y += p.speedY;
          
          if (p.x < 0) p.x = canvas.width;
          if (p.x > canvas.width) p.x = 0;
          if (p.y < 0) p.y = canvas.height;
          if (p.y > canvas.height) p.y = 0;
          
          // Draw particle
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fillStyle = `hsla(${p.hue}, 83%, 60%, ${p.opacity})`;
          ctx.shadowBlur = 10;
          ctx.shadowColor = `hsla(${p.hue}, 83%, 50%, 0.5)`;
          ctx.fill();
          
          // Connect nearby particles
          particles.slice(i + 1).forEach(p2 => {
            const dx = p.x - p2.x;
            const dy = p.y - p2.y;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist < 100) {
              ctx.beginPath();
              ctx.moveTo(p.x, p.y);
              ctx.lineTo(p2.x, p2.y);
              ctx.strokeStyle = `hsla(348, 83%, 50%, ${0.2 * (1 - dist / 100)})`;
              ctx.lineWidth = 0.5;
              ctx.stroke();
            }
          });
        });
        
        requestAnimationFrame(animate);
      }
      
      resize();
      createParticles();
      animate();
      
      window.addEventListener('resize', () => { resize(); createParticles(); });
      window.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; });
      window.addEventListener('mouseleave', () => { mouse.x = null; mouse.y = null; });
    }

    // ==================== AUDIO TOGGLE ====================
    let audioContext = null;
    let oscillators = [];
    let isPlaying = false;
    
    function initAudio() {
      const toggle = document.getElementById('audioToggle');
      const icon = document.getElementById('audioIcon');
      const waves = document.getElementById('soundWaves');
      
      toggle.addEventListener('click', async () => {
        if (!isPlaying) {
          if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const masterGain = audioContext.createGain();
            masterGain.gain.value = 0.15;
            masterGain.connect(audioContext.destination);
            
            const frequencies = [55, 82.5, 110, 165, 220];
            frequencies.forEach((freq, i) => {
              const osc = audioContext.createOscillator();
              const oscGain = audioContext.createGain();
              osc.type = i % 2 === 0 ? 'sine' : 'triangle';
              osc.frequency.value = freq;
              osc.detune.value = (Math.random() - 0.5) * 10;
              oscGain.gain.value = 0.3 / (i + 1);
              osc.connect(oscGain);
              oscGain.connect(masterGain);
              osc.start();
              oscillators.push(osc);
            });
            
            const lfo = audioContext.createOscillator();
            const lfoGain = audioContext.createGain();
            lfo.type = 'sine';
            lfo.frequency.value = 0.1;
            lfoGain.gain.value = 0.03;
            lfo.connect(lfoGain);
            lfoGain.connect(masterGain.gain);
            lfo.start();
          }
          
          if (audioContext.state === 'suspended') {
            await audioContext.resume();
          }
          
          isPlaying = true;
          toggle.classList.add('playing');
          icon.innerHTML = '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>';
          icon.style.color = 'hsl(var(--scarlet))';
          waves.style.display = 'block';
        } else {
          if (audioContext) {
            await audioContext.suspend();
          }
          isPlaying = false;
          toggle.classList.remove('playing');
          icon.innerHTML = '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/>';
          icon.style.color = 'hsl(var(--muted-foreground))';
          waves.style.display = 'none';
        }
      });
    }

    // ==================== TILT CARD ====================
    function initTiltCards() {
      document.querySelectorAll('.tilt-card').forEach(card => {
        card.addEventListener('mousemove', e => {
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          const intensity = parseFloat(card.dataset.intensity) || 15;
          const rotateX = ((y - centerY) / centerY) * -intensity;
          const rotateY = ((x - centerX) / centerX) * intensity;
          
          card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
          
          const glow = card.querySelector('.glow-overlay');
          if (glow) {
            glow.style.background = `radial-gradient(circle at ${(x/rect.width)*100}% ${(y/rect.height)*100}%, hsl(348 83% 50% / 0.3), transparent 50%)`;
          }
        });
        
        card.addEventListener('mouseleave', () => {
          card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)';
        });
      });
    }

    // ==================== MAGIC BUTTON ====================
    function initMagicButtons() {
      document.querySelectorAll('.magic-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          if (btn.disabled) return;
          
          const rect = btn.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          
          const burst = document.createElement('div');
          burst.className = 'energy-burst';
          burst.style.left = x + 'px';
          burst.style.top = y + 'px';
          burst.innerHTML = `
            <div class="burst-core"></div>
            <div class="burst-ring"></div>
            <svg class="burst-hex" viewBox="0 0 60 60">
              <polygon points="30,5 55,17.5 55,42.5 30,55 5,42.5 5,17.5" fill="none" stroke="hsl(348, 100%, 60%)" stroke-width="2" opacity="0.8"/>
            </svg>
            ${[0,45,90,135,180,225,270,315].map(angle => `<div class="burst-particle" style="transform: rotate(${angle}deg);"></div>`).join('')}
          `;
          
          btn.appendChild(burst);
          setTimeout(() => burst.remove(), 1000);
        });
      });
    }

    // ==================== INITIALIZE ====================
    document.addEventListener('DOMContentLoaded', () => {
      initDarkholdRunes();
      initHexOverlay();
      initChaosEnergy();
      initParticleField();
      initAudio();
      initTiltCards();
      initMagicButtons();
      setTimeout(triggerGlitch, 2000);
    });
  </script>
</body>
</html>
